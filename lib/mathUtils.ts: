export function clamp(value: number, min: number, max: number): number {
  return Math.min(Math.max(value, min), max);
}

// Simple Exponential Moving Average
export function EMA(data: number[], period: number): number {
  const k = 2 / (period + 1);
  let ema = data[0] ?? 0;
  for (let i = 1; i < data.length; i++) {
    ema = data[i] * k + ema * (1 - k);
  }
  return ema;
}

export function logReturns(data: number[]): number[] {
  const ret: number[] = [];
  for (let i = 1; i < data.length; i++) {
    ret.push(Math.log(data[i] / (data[i - 1] || 1)));
  }
  return ret;
}

export function stdDev(values: number[]): number {
  const mean = values.reduce((a, b) => a + b, 0) / (values.length || 1);
  return Math.sqrt(
    values.reduce((sq, n) => sq + Math.pow(n - mean, 2), 0) /
      (values.length || 1)
  );
}

export function sigmoid(x: number): number {
  return 1 / (1 + Math.exp(-x));
}
